<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>玩转 android 虚拟机 | FloatingGuy's Blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">玩转 android 虚拟机</h1><a id="logo" href="/.">FloatingGuy's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">玩转 android 虚拟机</h1><div class="post-meta">Apr 19, 2017<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2017/04/19/玩转-android-虚拟机/" href="/2017/04/19/玩转-android-虚拟机/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#从-navice-层创建-Android-VM"><span class="toc-number">1.</span> <span class="toc-text">从 navice 层创建 Android VM</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#在命令行调用-JNI-函数（参数可以包括-Java-对象）"><span class="toc-number">2.</span> <span class="toc-text">在命令行调用 JNI 函数（参数可以包括 Java 对象）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Harness-服务端工具"><span class="toc-number">2.1.</span> <span class="toc-text">Harness 服务端工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逆向-Dex"><span class="toc-number">2.2.</span> <span class="toc-text">逆向 Dex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定义一个-server-socket"><span class="toc-number">2.3.</span> <span class="toc-text">定义一个 server socket</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#准备："><span class="toc-number">2.3.1.</span> <span class="toc-text">准备：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用："><span class="toc-number">2.3.2.</span> <span class="toc-text">使用：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ChangeLog"><span class="toc-number">2.3.3.</span> <span class="toc-text">ChangeLog</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><p>作者：FloatingGuy 转载请注明出处：<a href="https://floatingguy.github.io/" target="_blank" rel="external">https://floatingguy.github.io/</a></p>
<hr>
<p>Title: <a href="https://calebfenton.github.io/2017/04/14/calling_jni_functions_with_java_object_arguments_from_the_command_line/" target="_blank" rel="external">Calling JNI Functions with Java Object Arguments from the Command Line</a></p>
<p>Core Skill: 在 native 层创建 Android 虚拟机，并调用 jni 方法。</p>
<p><a href="https://calebfenton.github.io/" target="_blank" rel="external">Caleb Fenton’s Blog</a>中包含很多关于 android 开发的技术，特别是虚拟机相关的技术。<strong>介绍的非常详细</strong></p>
<a id="more"></a>
<p>这里介绍 <a href="https://calebfenton.github.io" target="_blank" rel="external">Caleb Fenton’s Blog</a>中关于 Android 虚拟机的系列文章，对文章中的技术做汇总和实验。</p>
<p>目前作者给出了 如下2篇文章：</p>
<ul>
<li><a href="https://calebfenton.github.io/2017/04/05/creating_java_vm_from_android_native_code/" target="_blank" rel="external">Creating a Java VM from Android Native Code</a><br>介绍如何通过编写 Native 可执行文件，创建Android VM；本质就是调用 libdvm.so 中未开放的代码。</li>
<li><a href="https://calebfenton.github.io/2017/04/14/calling_jni_functions_with_java_object_arguments_from_the_command_line/" target="_blank" rel="external">Calling JNI Functions with Java Object Arguments from the Command Line</a></li>
</ul>
<p>重点介绍第二篇 文章， 因为第一篇只是一个技术基础。第二篇包含了一些案例 更有价值一些。</p>
<h1 id="从-navice-层创建-Android-VM"><a href="#从-navice-层创建-Android-VM" class="headerlink" title="从 navice 层创建 Android VM"></a>从 navice 层创建 Android VM</h1><p>在介绍第二篇之前先将第一篇公布的完整代码公布出来。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dlfcn.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(*JNI_CreateJavaVM_t)</span><span class="params">(<span class="keyword">void</span> *, <span class="keyword">void</span> *, <span class="keyword">void</span> *)</span></span>;</div><div class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">jint</span> <span class="params">(*registerNatives_t)</span><span class="params">(JNIEnv* env, jclass clazz)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">init_jvm</span><span class="params">(JavaVM **p_vm, JNIEnv **p_env)</span> </span>&#123;</div><div class="line">    <span class="comment">// https://android.googlesource.com/platform/frameworks/native/+/ce3a0a5/services/surfaceflinger/DdmConnection.cpp</span></div><div class="line">    JavaVMOption opt[<span class="number">4</span>];</div><div class="line">    opt[<span class="number">0</span>].optionString = <span class="string">"-Djava.class.path=/data/local/tmp/shim_app.apk"</span>;</div><div class="line">    opt[<span class="number">1</span>].optionString = <span class="string">"-agentlib:jdwp=transport=dt_android_adb,suspend=n,server=y"</span>;</div><div class="line">    opt[<span class="number">2</span>].optionString = <span class="string">"-Djava.library.path=/data/local/tmp"</span>;</div><div class="line">    opt[<span class="number">3</span>].optionString = <span class="string">"-verbose:jni"</span>; <span class="comment">// may want to remove this, it's noisy</span></div><div class="line">    JavaVMInitArgs args;</div><div class="line">    args.version = JNI_VERSION_1_6;</div><div class="line">    args.options = opt;</div><div class="line">    args.nOptions = <span class="number">4</span>;</div><div class="line">    args.ignoreUnrecognized = JNI_FALSE;</div><div class="line">    <span class="keyword">void</span> *libdvm_dso = dlopen(<span class="string">"libdvm.so"</span>, RTLD_NOW);</div><div class="line">    <span class="keyword">void</span> *libandroid_runtime_dso = dlopen(<span class="string">"libandroid_runtime.so"</span>, RTLD_NOW);</div><div class="line">    <span class="keyword">if</span> (!libdvm_dso || !libandroid_runtime_dso) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    JNI_CreateJavaVM_t JNI_CreateJavaVM;</div><div class="line">    JNI_CreateJavaVM = (JNI_CreateJavaVM_t) dlsym(libdvm_dso, <span class="string">"JNI_CreateJavaVM"</span>);</div><div class="line">    <span class="keyword">if</span> (!JNI_CreateJavaVM) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-2</span>;</div><div class="line">    &#125;</div><div class="line">    registerNatives_t registerNatives;</div><div class="line">    registerNatives = (registerNatives_t) dlsym(libandroid_runtime_dso, <span class="string">"Java_com_android_internal_util_WithFramework_registerNatives"</span>);</div><div class="line">    <span class="keyword">if</span> (!registerNatives) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-3</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (JNI_CreateJavaVM(&amp;(*p_vm), &amp;(*p_env), &amp;args)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-4</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (registerNatives(*p_env, <span class="number">0</span>)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-5</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="在命令行调用-JNI-函数（参数可以包括-Java-对象）"><a href="#在命令行调用-JNI-函数（参数可以包括-Java-对象）" class="headerlink" title="在命令行调用 JNI 函数（参数可以包括 Java 对象）"></a>在命令行调用 JNI 函数（参数可以包括 Java 对象）</h1><p>当破解或者分析恶意代码时，可能关键的值（字符串）是在 Native层计算出来的，这时候我们有几种办法获取native 函数的返回值。</p>
<ol>
<li>hook native函数   [简单、不稳定、不方便]</li>
<li>静态分析 native 函数算法，重写方法    [复杂]</li>
<li>动态调试     [更不方便]</li>
<li>插桩         [不方便、校验完整性的防护]</li>
<li>创建一个可执行文件，加载目标 so 调用目标函数。通过命令行传递参数给目标函数。     [简单、有局限（无法创建 JNIEnv参数）]</li>
<li>….</li>
</ol>
<p>下面我们会介绍 本文的技术来解决这个调用 jni 函数的问题。</p>
<p>首先下载我们的<a href="https://github.com/CalebFenton/native-harness-target" target="_blank" rel="external">实验app</a>, 使用下面的方法编译 apk.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/CalebFenton/native-harness-target.git</div><div class="line">cd native-harness-target</div><div class="line">echo &apos;ndk.dir=$ANDROID_NDK&apos; &gt; local.properties</div><div class="line">echo &apos;sdk.dir=$ANDROID_SDK&apos; &gt;&gt; local.properties</div><div class="line">./gradlew build</div></pre></td></tr></table></figure></p>
<p>APKs 输出目录：<code>app/build/outputs/apk/</code>。</p>
<p>实验的设备：Nexus5<br>系统版本：android 6.0.1</p>
<h2 id="Harness-服务端工具"><a href="#Harness-服务端工具" class="headerlink" title="Harness 服务端工具"></a>Harness 服务端工具</h2><p>Harness的灵感来自 shim项目，shim 的功能是加载 library 并调用其 JNI_OnLoad 函数。这样就简化了调试工作，现在只需要让调试器去启动 shim 并通过参数传递要目标 library，然后使用调试器下断点并 绕过 JNI_OnLoad。</p>
<p>首先我们需要使用上一节介绍的技术，在 native 层创建 java vm，并将 JavaVM 实例传递给 JNI_OnLoad 函数。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">printf</span>(<span class="string">" [+] Initializing JavaVM Instance\n"</span>);</div><div class="line">JavaVM *vm = <span class="literal">NULL</span>;</div><div class="line">JNIEnv *env = <span class="literal">NULL</span>;</div><div class="line"><span class="keyword">int</span> status = init_jvm(&amp;vm, &amp;env);</div><div class="line"><span class="keyword">if</span> (status == <span class="number">0</span>) &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">" [+] Initialization success (vm=%p, env=%p)\n"</span>, vm, env);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">" [!] Initialization failure (%i)\n"</span>, status);</div><div class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="built_in">printf</span>(<span class="string">" [+] Calling JNI_OnLoad\n"</span>);</div><div class="line">onLoadFunc(vm, <span class="literal">NULL</span>);</div></pre></td></tr></table></figure></p>
<p>最终在代码中开启一个 socket， 通过这个 socket 读取参数作为目标函数的参数。使用 python 脚本可以很容易与它进行交互。</p>
<p>python 脚本就是 在PC 上执行的 <strong>客户端</strong>了。</p>
<h2 id="逆向-Dex"><a href="#逆向-Dex" class="headerlink" title="逆向 Dex"></a>逆向 Dex</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">.local v1, "encryptedStringBytes":[B</div><div class="line">invoke-static &#123;&#125;, Lorg/cf/nativeharness/Cryptor;-&gt;getInstance()Lorg/cf/nativeharness/Cryptor;</div><div class="line">move-result-object v0</div><div class="line"></div><div class="line">.line 21</div><div class="line">.local v0, "c":Lorg/cf/nativeharness/Cryptor;</div><div class="line"></div><div class="line"># v3 contains a String made from encrypted bytes</div><div class="line">new-instance v3, Ljava/lang/String;</div><div class="line">invoke-direct &#123;v3, v1&#125;, Ljava/lang/String;-&gt;&lt;init&gt;([B)V</div><div class="line"></div><div class="line"># Call the decryption method, move result back to v3</div><div class="line">invoke-virtual &#123;v0, v3&#125;, Lorg/cf/nativeharness/Cryptor;-&gt;decryptString(Ljava/lang/String;)Ljava/lang/String;</div><div class="line"></div><div class="line">move-result-object v3</div></pre></td></tr></table></figure>
<p>注意：这里调用 native 函数的指令是<code>invoke-virtual</code>, 这个指令一般用来调用实例方法，虚方法等。指令的第一个参数就是 class 实例。</p>
<p>注意：native 方法 和 <code>invoke-virtual</code> 没有直接联系。存在 static native 的方法，这时候使用<code>invoke-static</code>，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">private static native void post_arm64Load0(Library this, long arg1) &#123;</div><div class="line">    &#125;</div><div class="line">.method private static native post_arm64Load0(J)V</div><div class="line">.end method</div><div class="line"></div><div class="line"></div><div class="line">调用代码</div><div class="line">00000060  iget-wide               v2, v0, Library-&gt;a:J</div><div class="line">00000064  invoke-static           Library-&gt;post_arm64Load0(J)V, v2, v3</div></pre></td></tr></table></figure></p>
<hr>
<p>下一步 我们要查看目标 jni 函数的签名，两种方法：</p>
<ol>
<li>通过反编译 so</li>
<li>但是方法1有可能 so 做了加固，查看不到函数签名；所以要使用 javah 生成头文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ d2j-dex2jar.sh app-universal-debug.apk</div><div class="line">dex2jar app-universal-debug.apk -&gt; ./app-universal-debug-dex2jar.jar</div><div class="line">$ javah -cp app-universal-debug-dex2jar.jar:$ANDROID_SDK/platforms/android-19/android.jar org.cf.nativeharness.Cryptor</div></pre></td></tr></table></figure>
</li>
</ol>
<p>jni 函数前2个参数是固定的，从第3个参数开始是应用的参数。<br>这个 jobject 参数应该是 <code>org.cf.nativeharness.Cryptor</code>实例，实际的函数签名：<br><code>JNIEXPORT jstring JNICALL Java_org_cf_nativeharness_Cryptor_decryptString (JNIEnv *, jobject, jstring);</code></p>
<p>定义目标函数类型：<br><code>typedef jstring(*decryptString_t)(JNIEnv *, jobject, jstring);</code></p>
<h2 id="定义一个-server-socket"><a href="#定义一个-server-socket" class="headerlink" title="定义一个 server socket"></a>定义一个 server socket</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h3 id="准备："><a href="#准备：" class="headerlink" title="准备："></a>准备：</h3><pre><code>1. 将目标 apk（或者 Dex、Jar）放在`/data/local/tmp/target-app.apk`,创建 VM 时的参数(`-Djava.class.path=/data/local/tmp/target-app.apk`)
2. 将需要的 native 库放在 `/data/local/tmp` (`-Djava.library.path=/data/local/tmp`)
3. 使用客户端  python 脚本时，需要 adb forward tcp:5001 tcp:5001
</code></pre><p>harness.c 文件主要负责：</p>
<ol>
<li>加载目标native 动态库</li>
<li>调用 native 中的 JNI_OnLoad 函数</li>
<li>创建 VM 虚拟机，加载目标 Dex 和 libs</li>
<li>[可选] 如果不是 <code>static native</code> 方法，需要创建实例对象 jobject, 如果是 static 方法可以给 jobject 传递 NULL.</li>
<li>开启 TCP socket server （5001端口）</li>
</ol>
<p>server.c 文件功能：</p>
<ol>
<li>绑定 TCP 服务到5001 端口， 负责从客户端接受 参数传递个解密函数。</li>
</ol>
<h3 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h3><p>harness  <libxx.so>   开启服务<br>decrypt_string.py</libxx.so></p>
<p>介绍完整个使用流程，第一感觉就是复杂,每次添加目标函数都要重新编译 harness,还不如 直接 frida-hook。确实，这种方法的好处是 适合解密量较大的情况。</p>
<p>如果要是换个 apk 破解，需要修改流程：</p>
<ol>
<li>找到要调用的 jni 函数，参看签名信息（是否需要创建 jobject）</li>
<li>[可选]在 harness.c 中 创建 class 实例</li>
<li>server.c 中修改 调用目标函数的代码。<br>注释不要删。。</li>
</ol>
<p>测试阶段：</p>
<ol>
<li>编译 apk 。。。</li>
</ol>
<h3 id="ChangeLog"><a href="#ChangeLog" class="headerlink" title="ChangeLog"></a>ChangeLog</h3><table>
<thead>
<tr>
<th>Time</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr>
<td>2017-4-19</td>
<td>创建</td>
</tr>
<tr>
<td></td>
<td>测试 art 模式</td>
</tr>
</tbody>
</table>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2017/04/19/玩转-android-虚拟机/" data-id="cj1uj018t002llqv26k99kffo" class="article-share-link">分享到</a><div class="tags"><a href="/tags/public-intelligence/">public intelligence</a></div><div class="post-nav"><a href="/2017/04/19/《三体》/" class="pre">《三体》</a><a href="/2017/04/10/Andorid-添加系统证书/" class="next">Andorid 添加系统证书</a></div><div data-thread-key="2017/04/19/玩转-android-虚拟机/" data-title="玩转 android 虚拟机" data-url="http://yoursite.com/2017/04/19/玩转-android-虚拟机/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2017/04/19/玩转-android-虚拟机/" data-title="玩转 android 虚拟机" data-url="http://yoursite.com/2017/04/19/玩转-android-虚拟机/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/开发/">开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/categories-fiddle/">捣鼓</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/categories-exploit/">漏洞</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/categories-life/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/categories-research/">研究</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/逆向/">逆向</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/blackhat-2016/" style="font-size: 15px;">blackhat-2016</a> <a href="/tags/hook/" style="font-size: 15px;">hook</a> <a href="/tags/了解/" style="font-size: 15px;">了解</a> <a href="/tags/kext/" style="font-size: 15px;">kext</a> <a href="/tags/xnu/" style="font-size: 15px;">xnu</a> <a href="/tags/mach/" style="font-size: 15px;">mach</a> <a href="/tags/public-intelligence/" style="font-size: 15px;">public intelligence</a> <a href="/tags/熟悉/" style="font-size: 15px;">熟悉</a> <a href="/tags/逻辑思维/" style="font-size: 15px;">逻辑思维</a> <a href="/tags/抓包/" style="font-size: 15px;">抓包</a> <a href="/tags/https/" style="font-size: 15px;">https</a> <a href="/tags/c/" style="font-size: 15px;">c</a> <a href="/tags/ios/" style="font-size: 15px;">ios</a> <a href="/tags/frida/" style="font-size: 15px;">frida</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/jeb/" style="font-size: 15px;">jeb</a> <a href="/tags/动态调试/" style="font-size: 15px;">动态调试</a> <a href="/tags/Armv8-64/" style="font-size: 15px;">Armv8-64</a> <a href="/tags/魔方/" style="font-size: 15px;">魔方</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/ios-osx/" style="font-size: 15px;">ios/osx</a> <a href="/tags/cocoa-app/" style="font-size: 15px;">cocoa app</a> <a href="/tags/AppVeyor/" style="font-size: 15px;">AppVeyor</a> <a href="/tags/CI/" style="font-size: 15px;">CI</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/19/《三体》/">《三体》</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/19/玩转-android-虚拟机/">玩转 android 虚拟机</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/10/Andorid-添加系统证书/">Andorid 添加系统证书</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/10/frida hook 操作手册/">Frida Hook 操作手册</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/28/Android-ELF-文件加壳/">Android ELF 文件加壳</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/java-ArrayList-String-add-用法说明/">java ArrayList<String>(){{add();}}; 用法说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/18/五阶魔方/">五阶魔方</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/16/逆向分析-cocoa-App/">逆向分析 cocoa App</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/16/OSX-FirstExtension-开发/">OSX FirstExtension 开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/XNU内核设计-Kext内核扩展/">XNU内核设计--Kext内核扩展</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 资源链接</i></div><ul></ul><a href="http://bbs.pediy.com/" title="看雪论坛" target="_blank">看雪论坛</a><ul></ul><a href="http://ddeville.me/" title="Damien DeVille" target="_blank">Damien DeVille</a><ul></ul><a href="http://nirvan.360.cn/blog/?cat=2" title="360Nirvan Team" target="_blank">360Nirvan Team</a><ul></ul><a href="https://googleprojectzero.blogspot.jp/" title="Project Zero" target="_blank">Project Zero</a><ul></ul><a href="http://shell-storm.org/blog/Triton-under-the-hood/" title="Jonathan Salwan" target="_blank">Jonathan Salwan</a><ul></ul><a href="http://cocoahuke.com/" title="Cocoa ‘for iOS/Mac’" target="_blank">Cocoa ‘for iOS/Mac’</a><ul></ul><a href="http://whereisk0shl.top/" title="whereisk0shl" target="_blank">whereisk0shl</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">FloatingGuy's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'floatingguy'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0550af547bfca45329cbf2afcc9fde43";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>